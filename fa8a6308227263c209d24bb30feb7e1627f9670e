{
  "comments": [
    {
      "key": {
        "uuid": "983328d2_2eac5a5d",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-09T09:05:37Z",
      "side": 1,
      "message": "This isn\u0027t enough. It doesn\u0027t work for new scripts. I need some magic here. Help wanted :)\n\n\nInstead of link adb/fastboot to /usr/bin/, adding the platform-tools folder seems to be the right way to go.",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 38,
        "endChar": 77
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b7327638_f6af5a1d",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1000006
      },
      "writtenOn": "2018-11-09T09:25:12Z",
      "side": 1,
      "message": "Why do the symlinks just to /usr/bin/fastboot not work? That worked in my testing. The only thing you should do with the platform-tools-folder is install the libraries used by the binaries into proper paths in /usr/lib/ but I haven\u0027t seen that to be necessary.\n\nSimplicity is the key here, avoid adding complexity to the existing support and avoid any dependency on bash or environment variables.",
      "parentUuid": "983328d2_2eac5a5d",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 38,
        "endChar": 77
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d154dff3_ed4f603d",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-09T10:01:39Z",
      "side": 1,
      "message": "I chose to update PATH for two reasons.\n\n* platform-tools is not just fastboot, we will need latest adb in some cases as well. And there are even more tools under the platform-tools folder.\n* When /usr/bin/fastboot or adb exists(installed from debian repo), we will have to uninstall or delete them. In this case, I thought adding the path of platform-tool directory to the beginning of PATH var is easier to do. Howerver, updating PATH var for all shells isn\u0027t easy...\n\nI am open to symlinks :)",
      "parentUuid": "b7327638_f6af5a1d",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 38,
        "endChar": 77
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "35c550bb_0b6d34af",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1000006
      },
      "writtenOn": "2018-11-09T10:23:13Z",
      "side": 1,
      "message": "It is up to the symlinked tools to handle their own shared library dependencies irrespective of symlinks and paths. If the tool doesn\u0027t work this way, the tool is badly broken.\nI tested with pre-installed packaged tools and replacing with symlinks works because that is how Debian and other distributions offer support for alternatives between binaries.\nDon\u0027t confuse binary filenames with shared library loading.",
      "parentUuid": "d154dff3_ed4f603d",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 38,
        "endChar": 77
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "66d1bcd7_d36eecd0",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-12T10:00:21Z",
      "side": 1,
      "message": "Thanks, Neil. I also tried to play the the adb/fastboot installed via apt. yeah, /usr/bin/fastboot also is a link(links to ../lib/android-sdk/platform-tools/adb*). I will move to symlinks. \n\nThe new code remove adb/fastboot if installed. and creat new links.",
      "parentUuid": "35c550bb_0b6d34af",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 38,
        "endChar": 77
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "35e607a6_2b23b6af",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-09T09:05:37Z",
      "side": 1,
      "message": "With shebang line \u0027#!/bin/sh\u0027, `~` doesn\u0027t expand. cd, cd ~ or cd $HOME don\u0027t work. Refer to https://validation.linaro.org/scheduler/job/1897330#L162\n\n@Neil, any idea?",
      "range": {
        "startLine": 41,
        "startChar": 3,
        "endLine": 41,
        "endChar": 9
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b68ff2b7_4acdd594",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000006
      },
      "writtenOn": "2018-11-09T09:25:12Z",
      "side": 1,
      "message": "Looks like it\u0027s running in a limited environment. There\u0027s no particular reason to need ~ you can simply hardcode a top level directory like /root/ with a check that it exists.",
      "parentUuid": "35e607a6_2b23b6af",
      "range": {
        "startLine": 41,
        "startChar": 3,
        "endLine": 41,
        "endChar": 9
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "00f14dfb_df4db4a8",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-09T10:01:39Z",
      "side": 1,
      "message": "Even with portable shell, I think \u0027~\u0027 is widely used, it works fine out of LAVA. I will do more debugging and file a issue with more informations.",
      "parentUuid": "b68ff2b7_4acdd594",
      "range": {
        "startLine": 41,
        "startChar": 3,
        "endLine": 41,
        "endChar": 9
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "273f6ab9_80d43ef7",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000006
      },
      "writtenOn": "2018-11-09T10:23:13Z",
      "side": 1,
      "message": "LAVA cannot guarantee any environment variables are set - that is entirely in the control of the lab admins. So you will need to abandon use of ~ - filing an issue won\u0027t help because LAVA cannot always know what the value should be.\n\nSpecific test jobs can set test job parameters but that\u0027s a bit heavyweight for this use case.",
      "parentUuid": "00f14dfb_df4db4a8",
      "range": {
        "startLine": 41,
        "startChar": 3,
        "endLine": 41,
        "endChar": 9
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "36b04aea_71391ae5",
        "filename": "automated/linux/android-platform-tools/install.sh",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-12T10:00:21Z",
      "side": 1,
      "message": "I am interested in finding out more about this, but I will leave it for now as it is not needed in this patch any more.",
      "parentUuid": "273f6ab9_80d43ef7",
      "range": {
        "startLine": 41,
        "startChar": 3,
        "endLine": 41,
        "endChar": 9
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6393e6f1_82e877e1",
        "filename": "automated/linux/android-platform-tools/install.yaml",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2018-11-09T09:05:37Z",
      "side": 1,
      "message": "To be removed.",
      "range": {
        "startLine": 12,
        "startChar": 16,
        "endLine": 12,
        "endChar": 17
      },
      "revId": "fa8a6308227263c209d24bb30feb7e1627f9670e",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    }
  ]
}