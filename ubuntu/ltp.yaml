metadata:
    name: ltp
    format: "Lava-Test-Shell Test Definition 1.0"
    description: "Run LTP syscalls tests"
    maintainer:
        - milosz.wasilewski@linaro.org
        - fathi.boudra@linaro.org
        - alex.bennee@linaro.org
    os:
        - ubuntu
        - debian
    scope:
        - functional
    devices:
        - panda
        - panda-es
        - arndale
        - vexpress-a9
        - vexpress-tc2
        - kvm
        - x86

params:
    # Modify chroot if you want to run inside a QEMU world after setting
    # up a chroot with install-qemu-chroot.yaml
    CHROOT: /
    # Last snapshot used is 20140115, set to HEAD for tip of tree (needed for aarch64)
    LTP_RELEASE: 20140115

install:
    steps:
      - chroot ${CHROOT} apt-get update
      - chroot ${CHROOT} apt-get install -y --force-yes git-core autoconf bzip2 flex bison build-essential wget
      - chroot ${CHROOT} ${PWD}/ubuntu/scripts/ltp-build.sh -r ${LTP_RELEASE}

run:
    steps:
      - chroot ${CHROOT} /home/ltp/build/runltp -f syscalls -p -q

parse:
    pattern: "^(?P<test_case_id>\\S+)\\s+\\d+\\s+(?P<result>\\w+)\\s+:\\s+.+"
    fixupdict:
        TBROK: fail
        TCONF: skip
        TFAIL: fail
        TINFO: skip
        TPASS: pass
        TWARN: unknown
