metadata:
    name: acpica
    format: "Lava-Test-Shell Test Definition 1.0"
    description:
        "ACPI ASL on ARMv7/ARMv8 - https://wiki.linaro.org/LEG/Engineering/test-acpi#ASLTS_-_ASL_Test_Suite
         There're 4 test modes (n32, n64, s32, s64). By default, we run test mode 'n64'
         The test mode can be specified by test job parameter:
         {
            'command': 'lava_test_shell',
            'parameters': {
                'testdef_repos': [
                    {
                        'git-repo': 'git://git.linaro.org/qa/test-definitions.git',
                        'parameters': {
                            'TESTMODE': 's64'
                        },
                        'testdef': 'ubuntu/acpica.yaml'
                    }
                ],
                'timeout': 172800
            }
         }"
    maintainer:
        - naresh.bhat@linaro.org
        - arthur.she@linaro.org
    os:
        - ubuntu
    devices:
        - rtsm_fvp_base-aemv8a
    scope:
        - functional

install:
    git-repos:
        - git://git.linaro.org/leg/acpica/acpica.git
    steps:
        - 'cd acpica'
        - 'git branch linaro origin/linaro'
        - 'git checkout linaro'
        - 'make all'
    deps:
        - git
        - git-core
        - bzip2
        - flex
        - bison
        - build-essential

params:
    TESTMODE: n64

run:
    steps:
        - "cd acpica/tests/"
        - "lava-test-case acpica --shell sudo ./aslts.sh -m $TESTMODE"
        - "../../ubuntu/scripts/acpica-parser.sh ."
        - "cd aslts/tmp/RESULTS/*; tar zcf result.tar.gz *"
        - "lava-test-case-attach acpica result.tar.gz"
        

parse:
    pattern: "(?P<test_case_id>[ :a-zA-Z0-9-]+):(?P<result>PASS|FAIL|SKIPPED|BLOCKED)"
    fixupdict:
        SKIPPED: skip
        FAIL: fail
        PASS: pass
        BLOCKED: unknown
