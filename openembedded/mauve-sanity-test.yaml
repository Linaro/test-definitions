metadata:
  name: mauve
  format: "Lava-Test-Shell Test Definition 1.0"
  description: "Mauve Sanity Test for Open Embedded"
  version: 1.0
  maintainer:
    - andrew.mcdermott@linaro.org
  os:
    - openembedded
  scope:
    - functional
  devices:
    - rtsm_ve-armv8

install:
  git-repos:
    - git://git.linaro.org/qa/test-definitions.git
    - git://git.linaro.org/leg/openjdk/mauve.git

run:
  steps:
    - 'PATH=$PATH:/lava/tests/$TESTRUN_ID/test-definitions/openembedded/scripts'
    - 'PATH=/usr/lib/jvm/java-8-openjdk/jre/bin:$PATH'
    - 'PATH=/usr/lib/jvm/java-8-openjdk/bin:$PATH'
    - 'which java'
    - 'java -version'
    - 'rm -rf /tmp/mauve'
    - 'ln -s /lava/tests/$TESTRUN_ID/mauve /tmp/mauve'
    - 'cd /tmp/mauve'
    - 'lava-test-case gnu.testlet.java.lang.Integer --shell mauve-test-pkg gnu/testlet/java/lang/Integer -compile no -showpasses 2>&1 | tee /tmp/mauve-gnu.testlet.java.lang.Integer.txt'
    - 'lava-test-case-attach gnu.testlet.java.lang.Integer /tmp/mauve-gnu.testlet.java.lang.Integer.txt text/plain'

# The following "parser" will correctly parse the output from the
# tests but it is deliberately commented out because you end up with
# one line per test case in the LAVA dashboard and, given the number
# of tests that are run, there will be ~250 pages to wade through.

# parse:
#   pattern: "(?P<result>(PASS|FAIL|SKIP)):\\s+(?P<test_case_id>(.*))"
#   fixupdict:
#     PASS: pass
#     FAIL: fail
#     SKIP: skip
